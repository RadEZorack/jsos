set $mod Mod4

# Always keep sway running even if shell crashes
exec_always sleep infinity &

### -----------------------
### Performance env vars
### -----------------------
# setenv WEBKIT_DISABLE_SANDBOX 1
# setenv WEBKIT_FORCE_COMPOSITING_MODE 1
# setenv WEBKIT_DISABLE_DMABUF_RENDERER 0
# setenv LIBGL_ALWAYS_SOFTWARE 0
# setenv MESA_GL_VERSION_OVERRIDE 4.1
# setenv MESA_GLSL_VERSION_OVERRIDE 410

# (Optional, usually improves GL stability)
# setenv WLR_RENDERER gl
# setenv WLR_NO_HARDWARE_CURSORS 1

set $HOME /home/parallels
set $WAYLAND_DISPLAY wayland-0
set $DISPLAY :0

# Start Jâ€™Core native Rust launcher
exec_always /usr/local/bin/jsos-launcher &

exec_always bash -c "cd '/home/parallels/jsos/jsos-dashboard' && npm run dev"

# Start MiniBrowser as the JSOS shell
# exec_always \
#     /usr/lib/aarch64-linux-gnu/webkit2gtk-4.1/MiniBrowser \
#     http://localhost:3000
exec_always {
    gsettings set org.gnome.desktop.interface cursor-theme 'Adwaita'
}

exec_always xsetroot -cursor_name left_ptr

# exec_always bash -c "sleep 2 && chromium-browser --app=http://localhost:3000"
exec_always bash -c "chromium --allow-insecure-localhost --user-data-dir=/tmp/chrome-dev --app=http://localhost:3000"

    
# Terminal
bindsym $mod+Return exec foot

# Exit sway
bindsym $mod+Shift+e exec "swaymsg exit"

# SkyAdmin (Return to login screen)
bindsym Ctrl+$mod+F12 exec "loginctl terminate-user parallels"

bindsym $mod+Shift+c kill
